<ApplicationProfile>
 	<namespaces>
  		<namespace ID="rdf"><![CDATA[http://www.w3.org/1999/02/22-rdf-syntax-ns#]]></namespace>
  		<namespace ID="iot"><![CDATA[http://www.arces.unibo.it/IoTGateway#]]></namespace>
  		<namespace ID="rdfs"><![CDATA[http://www.w3.org/2000/01/rdf-schema#]]></namespace>
  	</namespaces>
  	<deletes>
  		<delete ID="ALL" ><![CDATA[DELETE { ?s ?p ?o } WHERE { ?s ?p ?o }]]></delete>
  		<delete ID="MAPPING" ><![CDATA[DELETE { ?mapping ?p ?o } WHERE { ?mapping ?p ?o }]]></delete>
  		<delete ID="REQUEST" ><![CDATA[DELETE { ?request ?p ?o } WHERE { ?request ?p ?o }]]></delete>
  		<delete ID="RESPONSE" ><![CDATA[DELETE { ?response ?p ?o } WHERE { ?reponse ?p ?o }]]></delete>
  		<delete ID="RESOURCE" ><![CDATA[DELETE { ?resource ?p ?o } WHERE { ?resource ?p ?o }]]></delete>
  		<delete ID="REQUEST_RESPONSE" ><![CDATA[DELETE { ?request ?p ?o . ?response ?p1 ?o1} WHERE { ?request ?p ?o . ?response ?p1 ?o1 }]]></delete>
  	</deletes>
  	<inserts>
  		<insert ID="RESOURCE">
  		<![CDATA[INSERT DATA { ?resource rdf:type iot:Resource }]]></insert>
    	
    	<insert ID="MP_MAPPING">
    	<![CDATA[INSERT DATA { 
    	?mapping rdf:type iot:MP-Mapping . 
     	?mapping iot:hasProtocol ?protocol . 
     	?mapping iot:hasResource ?resource . 
     	?mapping iot:hasAction ?action . 
     	?mapping iot:hasValue ?value . 
     	?mapping iot:hasMPRequestPattern ?requestPattern . 
     	?mapping iot:hasMPResponsePattern ?responsePattern }]]></insert>	
     	
     	<insert ID="MP_REQUEST">
    	<![CDATA[INSERT DATA { 
    	?request rdf:type iot:MP-Request . 
    	?request iot:hasProtocol ?protocol . 
    	?request iot:hasMPRequestString ?value }]]></insert>
     	
     	<insert ID="MP_RESPONSE"><![CDATA[INSERT DATA { 
      	?response iot:generatedBy ?request . 
      	?response rdf:type iot:MP-Response . 
      	?response iot:hasMPResponseString ?value }]]></insert>	
      	   
      	<insert ID="MN_REQUEST"><![CDATA[INSERT DATA { 
      	?request rdf:type iot:MN-Request . 
      	?request iot:hasNetwork ?network . 
      	?request iot:hasMNRequestString ?value }]]></insert>
      		
    	<insert ID="MN_RESPONSE">
    	<![CDATA[INSERT DATA { 
    	?response rdf:type iot:MN-Response . 
    	?response iot:hasNetwork ?network . 
    	?response iot:hasMNResponseString ?value }]]></insert>
    	
    	<insert ID="MN_MAPPING">
    	<![CDATA[INSERT DATA { 
    	?mapping rdf:type iot:MN-Mapping . 
    	?mapping iot:hasNetwork ?network . 
    	?mapping iot:hasResource ?resource . 
      	?mapping iot:hasAction ?action . 
      	?mapping iot:hasValue ?value . 
      	?mapping iot:hasMNRequestPattern ?requestPattern . 
      	?mapping iot:hasMNResponsePattern ?responsePattern }]]></insert>	
    	  	
    	<insert ID="RESOURCE_PENDING_REQUEST"><![CDATA[INSERT DATA { 
      	?request rdf:type iot:Resource-Pending-Request . 
      	?request iot:hasValue ?value . 
      	?request iot:hasAction ?action . 
      	?request iot:hasResource ?resource }]]></insert>
    	       
        <insert ID="RESOURCE_RESPONSE"><![CDATA[INSERT DATA { 
      	?response rdf:type iot:Resource-Response . 
      	?response iot:hasAction ?action . 
      	?response iot:hasResource ?resource . 
      	?response iot:hasValue ?value }]]></insert>
    	
    	<insert ID="RESOURCE_REQUEST"><![CDATA[INSERT DATA { 
      	?request rdf:type iot:Resource-Request . 
      	?request iot:hasValue ?value . 
      	?request iot:hasAction ?action . 
      	?request iot:hasResource ?resource }]]></insert>
    </inserts>
  	<subscribes>
    	<subscribe ID="MP_REQUEST"><![CDATA[SELECT ?request ?protocol ?value WHERE { 
    	?request rdf:type iot:MP-Request . 
    	?request iot:hasProtocol ?protocol . 
    	?request iot:hasMPRequestString ?value }]]></subscribe>
    	
    	<subscribe ID="MP_RESPONSE"><![CDATA[SELECT ?response ?request ?value ?protocol WHERE { 
      	?response rdf:type iot:MP-Response . 
      	?response iot:generatedBy ?request . 
      	?response iot:hasMPResponseString ?value . 
      	?request iot:hasProtocol ?protocol }]]></subscribe>
    	
    	<subscribe ID="MP_MAPPING"><![CDATA[SELECT ?mapping ?protocol ?requestPattern ?responsePattern ?resource ?action ?value WHERE { 
      	?mapping rdf:type iot:MP-Mapping . 
      	?mapping iot:hasProtocol ?protocol . 
      	?mapping iot:hasResource ?resource . 
      	?mapping iot:hasAction ?action . 
      	?mapping iot:hasValue ?value . 
      	?mapping iot:hasMPRequestPattern ?requestPattern . 
      	?mapping iot:hasMPResponsePattern ?responsePattern }]]></subscribe>
      	      	
      	<subscribe ID="MN_REQUEST"><![CDATA[SELECT ?request ?value ?network WHERE { 
      	?request rdf:type iot:MN-Request . 
      	?request iot:hasNetwork ?network . 
      	?request iot:hasMNRequestString ?value }]]></subscribe>
	    
	    <subscribe ID="MN_RESPONSE"><![CDATA[SELECT ?response ?network ?value WHERE { 
	    ?response rdf:type iot:MN-Response . 
	    ?response iot:hasNetwork ?network . 
	    ?response iot:hasMNResponseString ?value }]]></subscribe>
      		          	
      	<subscribe ID="MN_MAPPING"><![CDATA[SELECT ?mapping ?network ?requestPattern ?responsePattern ?resource ?action ?value WHERE { 
      	?mapping rdf:type iot:MN-Mapping . 
      	?mapping iot:hasNetwork ?network . 
      	?mapping iot:hasResource ?resource . 
      	?mapping iot:hasAction ?action . 
      	?mapping iot:hasValue ?value . 
      	?mapping iot:hasMNRequestPattern ?requestPattern . 
      	?mapping iot:hasMNResponsePattern ?responsePattern }]]></subscribe>
    	
 		<subscribe ID="RESOURCE_REQUEST"><![CDATA[SELECT ?request ?value ?action ?resource WHERE { 
	   	?request rdf:type iot:Resource-Request . 
	   	?request iot:hasValue ?value . 
	    ?request iot:hasAction ?action . 
	    ?request iot:hasResource ?resource }]]></subscribe>
	       	
	    <subscribe ID="RESOURCE_RESPONSE"><![CDATA[SELECT ?response ?action ?resource ?value WHERE { 
	    ?response rdf:type iot:Resource-Response . 
	    ?response iot:hasAction ?action . 
	    ?response iot:hasResource ?resource . 
	    ?response iot:hasValue ?value }]]></subscribe>
			    
	    <subscribe ID="RESOURCE_PENDING_REQUEST"><![CDATA[SELECT ?request ?resource ?action ?value WHERE { 
	    ?request rdf:type iot:Resource-Pending-Request . 
	    ?request iot:hasValue ?value . 
	    ?request iot:hasAction ?action . 
	    ?request iot:hasResource ?resource .
	    OPTIONAL { ?resource rdf:type iot:Resource . ?resource iot:hasValue ?oldValue }}]]></subscribe>
	         	
      	<subscribe ID="ALL"><![CDATA[SELECT ?s ?p ?o WHERE { ?s ?p ?o }]]></subscribe>
  	</subscribes>
  	<updates>
  		<update ID="RESOURCE">
  		<![CDATA[
  		DELETE { ?resource iot:hasValue ?oldValue }
  		INSERT { ?resource iot:hasValue ?value }
  		WHERE { ?resource rdf:type iot:Resource . OPTIONAL { ?resource iot:hasValue ?oldValue } }]]> </update>
  		<update ID="MN_MAPPING">
  		<![CDATA[
  		DELETE { ?mapping ?pred ?obj }
  		INSERT { ?mapping rdf:type iot:MN-Mapping . 
      	?mapping iot:hasNetwork ?network . 
      	?mapping iot:hasResource ?resource . 
      	?mapping iot:hasAction ?action . 
      	?mapping iot:hasValue ?value . 
      	?mapping iot:hasMNRequestPattern ?requestPattern . 
      	?mapping iot:hasMNResponsePattern ?responsePattern }
  		WHERE { ?mapping ?pred ?obj . ?mapping rdf:type iot:MN-Mapping }]]> </update>
  		<update ID="MP_MAPPING">
  		<![CDATA[
  		DELETE { ?mapping ?pred ?obj }
  		INSERT { ?mapping rdf:type iot:MP-Mapping . 
      	?mapping iot:hasProtocol ?protocol . 
      	?mapping iot:hasResource ?resource . 
      	?mapping iot:hasAction ?action . 
      	?mapping iot:hasValue ?value . 
      	?mapping iot:hasMPRequestPattern ?requestPattern . 
      	?mapping iot:hasMPResponsePattern ?responsePattern }
  		WHERE { ?mapping ?pred ?obj . ?mapping rdf:type iot:MP-Mapping }]]> </update>
  	</updates>
</ApplicationProfile>